@using CP.i8n
@using CriticalPath.Data
@model Product
@{
    Layout = null;
}

<div class="form-group">
    @Html.Label(EntityStrings.ParentCategory, htmlAttributes: new { @class = "control-label col-lg-2 col-md-3 col-sm-3" })
    <div class="col-lg-5 col-md-6 col-sm-7">
        @Html.DropDownList("ParentCategoryId", null, ActionStrings.SelectPlease, htmlAttributes: new { @class = "form-control" })
    </div>
</div>
<div class="form-group">
    @Html.LabelFor(model => model.CategoryId, htmlAttributes: new { @class = "control-label col-lg-2 col-md-3 col-sm-3" })
    <div class="col-lg-5 col-md-6 col-sm-7">
        @Html.DropDownList("CategoryId", null, ActionStrings.SelectPlease, htmlAttributes: new { @class = "form-control" })
        @Html.ValidationMessageFor(m => m.CategoryId, "", new { @class = "text-danger" })
    </div>
</div>
<script type="text/javascript">
    $('#ParentCategoryId').change(function () {
        var selectedId = $(this).val();
        if (selectedId != null && selectedId != '') {
            $.getJSON('/ProductCategories/SubCategories', { parentCategoryId: selectedId }, function (subCategories) {
                var targetSelect = $('#CategoryId');
                targetSelect.empty();
                targetSelect.append($('<option/>', {
                    value: '',
                    text: '@ActionStrings.SelectPlease'
                }));
                $.each(subCategories, function (index, subCategory) {
                    targetSelect.append($('<option/>', {
                        value: subCategory.Id,
                        text: subCategory.Title
                    }));
                });
            });
        }
    });
</script>